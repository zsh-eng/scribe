---
import type { Session } from "../lib/db";
import { slugify } from '../lib/slugify';

interface Props {
    session: Session;
}

const { session } = Astro.props;

// Helper to format ordinal numbers (1st, 2nd, 3rd, etc.)
function getOrdinal(n: number): string {
    const s = ["th", "st", "nd", "rd"];
    const v = n % 100;
    return n + (s[(v - 20) % 10] || s[v] || s[0]);
}

const formattedDate = new Date(session.date).toLocaleDateString("en-SG", {
    day: "numeric",
    month: "long",
    year: "numeric",
});
---

<a
    href={`/sessions/${slugify(session.date, session.id)}`}
    class="group grid grid-cols-[140px_1fr_auto] items-center gap-6 py-4 border-b border-border transition-colors hover:bg-warm cursor-pointer px-2"
    data-pagefind-meta={`id:${session.id}`}
>
    <div class="font-display text-base text-ink">
        {formattedDate}
    </div>
    <div class="font-sans text-sm text-ink-muted">
        {getOrdinal(session.parliament)} Parliament · {
            getOrdinal(session.sessionNo)
        } Session · {getOrdinal(session.sittingNo)} Sitting
    </div>
    <div class="font-sans text-xs text-ink-soft">
        {session.sectionCount !== undefined && `${session.sectionCount} items`}
    </div>
</a>
